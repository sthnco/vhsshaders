<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VHS Depth Distortion</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <div id="left-panel">
            <div class="control-group">
                <label>Upload</label>
                <label for="imageInput" class="upload-btn">
                    Choose Image
                    <input type="file" id="imageInput" accept="image/*">
                </label>
                <div id="status">Ready</div>
            </div>

            <div id="layers-panel" class="hidden">
                <h3>Layers</h3>
                <div class="layers-list">
                    <div class="layer-item" data-layer="source">
                        <canvas class="layer-thumb" id="thumb-source"></canvas>
                        <span class="layer-name">Source</span>
                    </div>
                    <div class="layer-item" data-layer="depth">
                        <canvas class="layer-thumb" id="thumb-depth"></canvas>
                        <span class="layer-name">Depth Map</span>
                    </div>
                    <div class="layer-item selected" data-layer="effect">
                        <canvas class="layer-thumb" id="thumb-effect"></canvas>
                        <span class="layer-name">VHS Effect</span>
                    </div>
                    <div class="layer-item" data-layer="splat">
                        <canvas class="layer-thumb" id="thumb-splat"></canvas>
                        <span class="layer-name">3D Splat</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="canvas-container">
            <canvas id="canvas"></canvas>
            <div id="light-handle" class="hidden">
                <div class="light-center"></div>
                <div class="light-direction"></div>
                <div class="light-rotate-handle"></div>
            </div>
        </div>

        <div id="debug-panel">
            <h3>Controls</h3>

            <div class="control-group">
                <label>Contours</label>
                <div class="slider-row">
                    <span>Count</span>
                    <input type="range" id="contourCount" min="5" max="60" value="25" step="1">
                    <span class="value" id="contourCount-val">25.0</span>
                </div>
                <div class="slider-row">
                    <span>Thickness</span>
                    <input type="range" id="lineThickness" min="0.5" max="20" value="1.5" step="0.5">
                    <span class="value" id="lineThickness-val">1.5</span>
                </div>
            </div>

            <div class="control-group">
                <label>Waves</label>
                <div class="slider-row">
                    <span>Amplitude</span>
                    <input type="range" id="waveAmplitude" min="0" max="0.03" value="0.008" step="0.001">
                    <span class="value" id="waveAmplitude-val">0.0</span>
                </div>
                <div class="slider-row">
                    <span>Frequency</span>
                    <input type="range" id="waveFrequency" min="10" max="150" value="50" step="5">
                    <span class="value" id="waveFrequency-val">50.0</span>
                </div>
                <div class="slider-row">
                    <span>Speed</span>
                    <input type="range" id="waveSpeed" min="0" max="5" value="2" step="0.1">
                    <span class="value" id="waveSpeed-val">2.0</span>
                </div>
            </div>

            <div class="control-group">
                <label>Glow</label>
                <div class="slider-row">
                    <span>Intensity</span>
                    <input type="range" id="glowIntensity" min="0" max="1.5" value="0.6" step="0.05">
                    <span class="value" id="glowIntensity-val">0.6</span>
                </div>
                <div class="slider-row">
                    <span>Size</span>
                    <input type="range" id="glowSize" min="1" max="5" value="2" step="0.5">
                    <span class="value" id="glowSize-val">2.0</span>
                </div>
            </div>

            <div class="control-group">
                <label>Color</label>
                <div class="color-row">
                    <span>Glow</span>
                    <input type="color" id="glowColor" value="#1a4de6">
                    <input type="text" id="glowColorHex" value="#1a4de6" maxlength="7" class="hex-input">
                </div>
                <div class="slider-row">
                    <span>Brightness</span>
                    <input type="range" id="lineBrightness" min="0.3" max="1" value="0.9" step="0.05">
                    <span class="value" id="lineBrightness-val">0.9</span>
                </div>
            </div>

            <div class="control-group">
                <label>VHS Effects</label>
                <div class="slider-row">
                    <span>Grain</span>
                    <input type="range" id="grainAmount" min="0" max="0.4" value="0.15" step="0.01">
                    <span class="value" id="grainAmount-val">0.2</span>
                </div>
                <div class="slider-row">
                    <span>Scanlines</span>
                    <input type="range" id="scanlineIntensity" min="0" max="0.3" value="0.08" step="0.01">
                    <span class="value" id="scanlineIntensity-val">0.1</span>
                </div>
                <div class="slider-row">
                    <span>Jitter</span>
                    <input type="range" id="jitterAmount" min="0" max="0.01" value="0.002" step="0.0005">
                    <span class="value" id="jitterAmount-val">0.0</span>
                </div>
            </div>

            <div class="control-group">
                <label>Post</label>
                <div class="slider-row">
                    <span>Vignette</span>
                    <input type="range" id="vignetteIntensity" min="0" max="0.6" value="0.3" step="0.05">
                    <span class="value" id="vignetteIntensity-val">0.3</span>
                </div>
            </div>

            <div class="control-group">
                <label>Lighting</label>
                <div class="checkbox-row">
                    <input type="checkbox" id="lightEnabled">
                    <span>Enable Light</span>
                </div>
                <div class="color-row">
                    <span>Color</span>
                    <input type="color" id="lightColor" value="#ffffff">
                    <input type="text" id="lightColorHex" value="#ffffff" maxlength="7" class="hex-input">
                </div>
                <div class="slider-row">
                    <span>Radius</span>
                    <input type="range" id="lightRadius" min="0.1" max="1.5" value="0.4" step="0.05">
                    <span class="value" id="lightRadius-val">0.4</span>
                </div>
                <div class="slider-row">
                    <span>Intensity</span>
                    <input type="range" id="lightIntensity" min="0" max="2" value="1" step="0.1">
                    <span class="value" id="lightIntensity-val">1.0</span>
                </div>
                <div class="slider-row">
                    <span>Dispersion</span>
                    <input type="range" id="lightDispersion" min="0.5" max="4" value="1.5" step="0.1">
                    <span class="value" id="lightDispersion-val">1.5</span>
                </div>
                <div class="slider-row">
                    <span>Depth</span>
                    <input type="range" id="lightDepthInfluence" min="0" max="1" value="0.5" step="0.05">
                    <span class="value" id="lightDepthInfluence-val">0.5</span>
                </div>
                <div class="slider-row">
                    <span>Cone</span>
                    <input type="range" id="lightConeAngle" min="0.2" max="3.14" value="3.14" step="0.1">
                    <span class="value" id="lightConeAngle-val">3.1</span>
                </div>
                <div class="hint">Click canvas to position light. Drag handle to rotate direction.</div>
            </div>

            <div class="control-group" id="splat-controls" style="display: none;">
                <label>3D Splat</label>
                <div class="slider-row">
                    <span>Size</span>
                    <input type="range" id="pointSize" min="5" max="40" value="15" step="1">
                    <span class="value" id="pointSize-val">15.0</span>
                </div>
                <div class="slider-row">
                    <span>Depth</span>
                    <input type="range" id="depthScale" min="0.5" max="4" value="1.5" step="0.1">
                    <span class="value" id="depthScale-val">1.5</span>
                </div>
                <div class="hint">Drag to rotate, Right-drag to pan, Scroll to zoom</div>
            </div>
        </div>

        <div id="loading" class="hidden">
            <div class="spinner"></div>
            <div id="loading-text">Loading depth model...</div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>
